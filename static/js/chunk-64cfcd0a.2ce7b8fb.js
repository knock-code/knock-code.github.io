(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64cfcd0a"],{1207:function(t,e,a){},"127f":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:"请输入数据库的账号密码",visible:t.centerDialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"30%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e},close:function(e){return t.dialogClose()}}},[a("el-form",{attrs:{model:t.dbInfo}},[a("el-form-item",{attrs:{label:"账号","label-width":t.formLabelWidth,required:""}},[a("el-input",{attrs:{autocomplete:"off",clearable:""},model:{value:t.dbInfo.username,callback:function(e){t.$set(t.dbInfo,"username",e)},expression:"dbInfo.username"}})],1),a("el-form-item",{attrs:{label:"密码","label-width":t.formLabelWidth,required:""}},[a("el-input",{attrs:{autocomplete:"off","show-password":"",clearable:""},model:{value:t.dbInfo.password,callback:function(e){t.$set(t.dbInfo,"password",e)},expression:"dbInfo.password"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:t.isOkLoading,type:"primary"},on:{click:function(e){return t.getTablesMySql()}}},[t._v("确 定")])],1)],1),t.tables_data.length>0?a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"tables-left"},[t._m(0),a("div",{staticClass:"tables-content"},t._l(t.tables_data,(function(e,i){return a("div",{staticClass:"tables-item"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e,placement:"top"}},[a("div",{ref:"show",refInFor:!0,staticStyle:{width:"150px",cursor:"pointer","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v(t._s(e)+" ")])]),a("CreateAnalyse",{ref:"CreateAnalyse",refInFor:!0,staticStyle:{width:"100%",height:"100%"},attrs:{"filed-data":t.filedData}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-s-data",circle:"",size:"mini"},on:{click:function(a){return t.createAnalyse(e)}}}),a("el-button",{attrs:{type:"warning",icon:"el-icon-tickets",size:"mini",circle:""},on:{click:function(a){return t.showData(e)}}}),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],attrs:{title:t.showTitle+"表预览数据",visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-table",{attrs:{data:t.gridData,height:"400px"}},t._l(t.filedData,(function(t,e){return a("el-table-column",{attrs:{property:t.columnName,label:t.comment,width:"150"}})})),1)],1)],1)})),0)]),a("div",{staticClass:"record-range"},[a("div",{staticClass:"query-record"},[a("div",{staticStyle:{"margin-top":"10px","margin-left":"13px"}},[a("el-input",{staticStyle:{width:"auto","margin-bottom":"15px"},attrs:{placeholder:"请输入搜索内容",clearable:""},on:{input:t.searchQuery},model:{value:t.searchRecordInput,callback:function(e){t.searchRecordInput=e},expression:"searchRecordInput"}})],1),a("div",{staticStyle:{"margin-top":"10px","margin-left":"90px"}},[a("el-date-picker",{attrs:{type:"datetimerange","picker-options":t.pickerOptions,"value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},on:{change:t.timeRangeQuery},model:{value:t.timeRange,callback:function(e){t.timeRange=e},expression:"timeRange"}})],1)]),a("div",{staticStyle:{width:"100%",height:"86%","overflow-y":"auto","padding-top":"13px","padding-left":"13px","padding-right":"13px","margin-top":"10px"}},[a("el-table",{staticStyle:{width:"100%","overflow-y":"hidden"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{fixed:"",prop:"name",label:"名称",width:"200"}}),a("el-table-column",{attrs:{prop:"tablename",label:"表名",width:"200"}}),a("el-table-column",{attrs:{prop:"createtime",label:"创建时间",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatTimer")(e.row.createtime))+" ")]}}],null,!1,1035147089)}),a("el-table-column",{attrs:{prop:"version",label:"版本号",width:"80"}}),a("el-table-column",{attrs:{prop:"createby",label:"创建人",width:"200"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.lookOneRecordClick(e.row)}}},[t._v("查看")]),a("el-button",{attrs:{type:"text",size:"small"}},[t._v("新版本")]),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.deleteAnalyseRecord(e.row)}}},[t._v("删除")])]}}],null,!1,3282174748)})],1)],1),a("el-dialog",{attrs:{"before-close":t.clearData,title:"分析记录",width:"60%",visible:t.analyseRecordOne},on:{"update:visible":function(e){t.analyseRecordOne=e}}},[a("div",{ref:"showAnalyseRecord",staticStyle:{width:"1000px",height:"400px"}})]),a("el-pagination",{staticStyle:{"margin-left":"13px"},attrs:{"page-size":8,background:"",layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.switchPage}})],1)]):t._e()],1)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tables-title"},[a("div",[t._v(" 表信息 ")])])}],s=(a("b0c0"),a("159b"),a("b64b"),a("f076")),l=a("cd61"),o={name:"index",components:{CreateAnalyse:l["default"]},data:function(){return{centerDialogVisible:!0,dbInfo:{username:"",password:""},formLabelWidth:"100px",tables_data:[],gridData:[],filedData:[],dialogTableVisible:!1,dialogAnalyseVisible:!1,isLoading:!0,isOkLoading:!1,showTitle:"",showCreateAnalyse:!1,searchRecordInput:"",timeRange:null,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},total:0,tableData:[],analyseData:{size:8,current:1,condition:{lk_name:"",be_createtime:""}},analyseRecordOne:!1,xData:[],yData:[],title_analyse:""}},methods:{dialogClose:function(){this.centerDialogVisible=!1},getTablesMySql:function(){var t=this;this.isOkLoading=!0,Object(s["g"])(this.dbInfo).then((function(e){var a=e.data;a.status?(t.$notify({title:"成功",message:a.msg,type:"success"}),t.isOkLoading=!1,t.centerDialogVisible=!1,t.tables_data=a.data,t.getAnalyseDataList()):t.$notify.error({title:"失败",message:a.msg})})).catch((function(t){console.log(t)}))},onSubmit:function(){console.log("你好!")},createAnalyse:function(t){var e=this;Object(s["e"])(t).then((function(a){var i=a.data;i.status?(e.filedData=i.data,e.showCreateAnalyse=!0,e.$nextTick((function(){e.$refs.CreateAnalyse[0].init(t)}))):e.$notify.error({title:"失败",message:i.msg})})).catch((function(t){console.log(t)}))},showData:function(t){var e=this;Object(s["e"])(t).then((function(a){var i=a.data;i.status?(e.filedData=i.data,e.getShowInfoData(t),e.showTitle=t,e.dialogTableVisible=!0):e.$notify.error({title:"失败",message:i.msg})})).catch((function(t){console.log(t)}))},getShowInfoData:function(t){var e=this;Object(s["f"])(t).then((function(t){var a=t.data;a.status?(e.$notify({title:"成功",message:a.msg,type:"success"}),e.gridData=a.data,e.isLoading=!1):e.$notify.error({title:"失败",message:a.msg})})).catch((function(t){console.log(t)}))},searchQuery:function(t){this.analyseData.condition.lk_name=t,this.getAnalyseDataList()},switchPage:function(t){this.analyseData.current=t,this.getAnalyseDataList()},lookOneRecordClick:function(t){var e=this;this.title_analyse=t.name,Object(s["c"])({sql:t.sqldata}).then((function(t){var a=t.data;if(a.status){var i=a.data.result;i.forEach((function(t,a){var i=Object.keys(t);e.xData.push(t[i[0]]),e.yData.push(t[i[1]])})),e.analyseRecordOne=!0}else e.$message.error(a.msg)})).catch((function(t){console.log(t)})),console.log(t)},getAnalyseDataList:function(){var t=this;Object(s["b"])(this.analyseData).then((function(e){var a=e.data;a.status?(t.total=a.data.count,t.tableData=a.data.list):t.$message.error(a.msg)})).catch((function(t){console.log(t)}))},deleteAnalyseRecord:function(t){var e=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["a"])(t.id).then((function(t){var a=t.data;a.status?(e.$message.error(a.msg),e.getAnalyseDataList()):e.$message.error(a.msg)})).catch((function(t){console.log(t)}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},timeRangeQuery:function(t){t&&(this.analyseData.condition.be_createtime=t[0]+"/"+t[1],this.getAnalyseDataList())},initCharts:function(){var t=this.$echarts.init(this.$refs.showAnalyseRecord);t.setOption({title:{text:this.title_analyse},tooltip:{},xAxis:{data:this.xData},yAxis:{},series:[{type:"line",data:this.yData}]},!0)},clearData:function(){this.$echarts.init(this.$refs.showAnalyseRecord).clear(),this.xData=[],this.yData=[],this.analyseRecordOne=!1}},updated:function(){this.yData.length>0&&this.xData.length>0&&this.initCharts()},mounted:function(){},created:function(){},filters:{formatTimer:function(t){var e=new Date(t),a=e.getFullYear(),i=e.getMonth()+1;i=i<10?"0"+i:i;var n=e.getDate();n=n<10?"0"+n:n;var s=e.getHours();s=s<10?"0"+s:s;var l=e.getMinutes();l=l<10?"0"+l:l;var o=e.getSeconds();return o=o<10?"0"+o:o,a+"-"+i+"-"+n+" "+s+":"+l}}},r=o,c=(a("5979"),a("2877")),d=Object(c["a"])(r,i,n,!1,null,null,null);e["default"]=d.exports},5979:function(t,e,a){"use strict";a("1207")}}]);