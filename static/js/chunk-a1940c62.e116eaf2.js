(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a1940c62"],{"04e7":function(t,e,l){},"741b":function(t,e,l){"use strict";l.r(e);var a=function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("el-row",[l("el-col",{attrs:{span:14}},[l("div",{staticClass:"frame"},[l("div",[l("b",{staticStyle:{"font-size":"25px",color:"#f56c6c"}},[t._v("我的求助")]),l("el-button",{staticStyle:{"margin-top":"5px",float:"right","margin-right":"10px"},attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:function(e){return t.addHelp()}}},[t._v("新求助 ")]),l("el-dialog",{attrs:{title:"新增求助",visible:t.addHelpDialog},on:{"update:visible":function(e){t.addHelpDialog=e}}},[l("el-form",{attrs:{model:t.form}},[l("el-form-item",{attrs:{label:"求助标题",required:"","label-width":t.formLabelWidth}},[l("el-input",{attrs:{maxlength:"20","show-word-limit":"",placeholder:"请输入求助的标题",autocomplete:"off"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),l("el-form-item",{attrs:{label:"求助类型",required:"","label-width":t.formLabelWidth}},[l("el-select",{staticStyle:{width:"250px"},attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请定义求助类型Enter选中"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.options,(function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),l("el-form-item",{attrs:{label:"联系电话",required:"","label-width":t.formLabelWidth}},[l("el-input",{attrs:{type:"text",onkeyup:"value=value.replace(/[^\\d]/g,0)",maxlength:"11","show-word-limit":"",placeholder:"请填写您的联系方式"},model:{value:t.form.contact,callback:function(e){t.$set(t.form,"contact",e)},expression:"form.contact"}})],1),l("el-form-item",{attrs:{label:"联系地址",required:"","label-width":t.formLabelWidth}},[l("el-input",{attrs:{maxlength:"30","show-word-limit":"",placeholder:"请填写您的联系地址",autocomplete:"off"},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1),l("el-form-item",{attrs:{label:"关联灾害",required:"","label-width":t.formLabelWidth}},[l("el-select",{attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词检索灾害","remote-method":t.remoteMethod},model:{value:t.form.disasterid,callback:function(e){t.$set(t.form,"disasterid",e)},expression:"form.disasterid"}},t._l(t.disasterOptions,(function(t){return l("el-option",{key:t.id,attrs:{label:t.cnname,value:t.id}})})),1)],1),l("el-form-item",{attrs:{label:"具体内容",required:"","label-width":t.formLabelWidth}},[l("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},maxlength:"100","show-word-limit":"",placeholder:"请输入具体求助信息",autocomplete:"off"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:t.clearFromInfo}},[t._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:t.okAddHelp}},[t._v("确 定")])],1)],1)],1),l("div",{staticStyle:{border:"1px solid #f56c6c",margin:"10px",height:"550px"}},[l("el-table",{staticStyle:{width:"100%"},attrs:{data:t.myTableData,"row-class-name":t.tableRowClassName}},[l("el-table-column",{attrs:{prop:"isfinish",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isfinish?l("b",{staticStyle:{color:"#51e614"}},[t._v("完成")]):t._e(),e.row.isfinish?t._e():l("b",{staticStyle:{color:"#f56c6c"}},[t._v("未完成")])]}}])}),l("el-table-column",{attrs:{prop:"title",label:"求助标题",width:"180"}}),l("el-table-column",{attrs:{prop:"createtime",label:"发布时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatTimer")(e.row.createtime))+" ")]}}])}),l("el-table-column",{attrs:{prop:"type",label:"类型",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.type,(function(e){return l("el-tag",{attrs:{type:"success",size:"mini"}},[t._v(t._s(e))])}))}}])}),l("el-table-column",{attrs:{fixed:"right",label:"操作",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-button",{attrs:{disabled:e.row.isfinish,type:"text",size:"small"},on:{click:function(l){return t.finishMyHelpClick(e.row)}}},[t._v("完成")]),l("el-button",{staticStyle:{color:"#38e2ff"},attrs:{type:"text",size:"small"},on:{click:function(l){return t.lookMyHelpClick(e.row)}}},[t._v("查看")]),l("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(l){return t.deleteMyHelpClick(e.row)}}},[t._v("删除")])]}}])})],1)],1),l("el-pagination",{staticStyle:{"margin-left":"13px"},attrs:{"page-size":8,background:"",layout:"total, prev, pager, next",total:t.totalMy},on:{"current-change":t.switchPageMy}}),l("el-dialog",{attrs:{title:t.helpInfo.title,visible:t.helpInfoShowDialog,width:"30%"},on:{"update:visible":function(e){t.helpInfoShowDialog=e}}},[l("div",{staticStyle:{"font-size":"20px"}},[l("div",[t._v("时间："),l("b",[t._v(t._s(t._f("formatTimer")(t.helpInfo.createtime)))])]),l("div",[t._v("内容："),l("b",[t._v(t._s(t.helpInfo.content))])]),l("div",[t._v("联系地址："),l("b",[t._v(t._s(t.helpInfo.address))])]),l("div",[t._v("联系电话："),l("b",[t._v(t._s(t.helpInfo.contact))])]),l("div",t._l(t.helpInfo.type,(function(e){return l("el-tag",{attrs:{type:"success",size:"mini"}},[t._v(t._s(e))])})),1),l("br")])])],1)]),l("el-col",{attrs:{span:10}},[l("div",{staticClass:"frame"},[l("b",{staticStyle:{"font-size":"25px",color:"#ffc400"}},[t._v("全部求助")]),l("div",{staticStyle:{border:"1px solid #ffc400",margin:"5px",height:"550px"}},[l("el-table",{staticStyle:{width:"100%",cursor:"pointer"},attrs:{data:t.allTableData,title:"点击查看详情","row-class-name":t.tableRowClassName},on:{"row-click":t.allShowClick}},[l("el-table-column",{attrs:{prop:"title",label:"求助标题",width:"180"}}),l("el-table-column",{attrs:{prop:"createtime",label:"发布时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatTimer")(e.row.createtime))+" ")]}}])}),l("el-table-column",{attrs:{prop:"type",label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.type,(function(e){return l("el-tag",{attrs:{type:"success",size:"mini"}},[t._v(t._s(e))])}))}}])})],1)],1),l("el-pagination",{staticStyle:{"margin-left":"13px","margin-top":"5px"},attrs:{"page-size":10,background:"",layout:"total, prev, pager, next",total:t.totalAll},on:{"current-change":t.switchPageALL}})],1)])],1)],1)},o=[],i=l("2949"),s=l("f2d1"),r={name:"index",updated:function(){},created:function(){this.getHelpList(this.myHelpData),this.getHelpList(this.allHelpData)},methods:{tableRowClassName:function(t){var e=t.row;t.rowIndex;return e.isfinish?"success-row":"warning-row"},deleteMyHelpClick:function(t){var e=this;this.$confirm("此操作将永久删除该求助, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["b"])(t.id).then((function(t){var l=t.data;l.status?(e.$message({message:l.msg,type:"success"}),e.getHelpList(e.myHelpData)):e.$message.error(l.msg)})).catch((function(t){console.log(t)}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},lookMyHelpClick:function(t){this.helpInfo=t,this.helpInfoShowDialog=!0},switchPageMy:function(t){this.myHelpData.current=t,this.getHelpList(this.myHelpData)},switchPageALL:function(t){this.allHelpData.current=t,this.getHelpList(this.allHelpData)},addHelp:function(){this.addHelpDialog=!0},remoteMethod:function(t){var e=this;""!==t?(console.log(t),Object(i["q"])({lk_cnname:t}).then((function(t){var l=t.data;l.status?(console.log(l.data),e.disasterOptions=l.data):e.$message.error(l.msg)})).catch((function(t){console.log(t)}))):this.disasterOptions=[]},okAddHelp:function(){var t=this;this.form.type&&this.form.title&&this.form.contact&&this.form.content&&this.form.disasterid&&this.form.address?Object(s["a"])(this.form).then((function(e){var l=e.data;l.status?(t.$message({message:l.msg,type:"success"}),t.clearFromInfo(),t.getHelpList(t.myHelpData)):t.$message.error(l.msg)})).catch((function(t){console.log(t)})):this.$message.error("求助信息不完整!")},clearFromInfo:function(){this.form.disasterid="",this.form.content="",this.form.contact="",this.form.title="",this.form.address="",this.form.type=[],this.addHelpDialog=!1},getHelpList:function(t){var e=this;Object(s["f"])(t).then((function(t){var l=t.data;l.status?l.data.list[0].createby===e.$store.getters.userid?(e.totalMy=l.data.count,e.myTableData=l.data.list):(e.totalAll=l.data.count,e.allTableData=l.data.list):e.$message.error(l.msg)})).catch((function(t){console.log(t)}))},finishMyHelpClick:function(t){var e=this;this.$confirm("此操作将达成求助不会展示给他人了, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["c"])(t.id).then((function(t){var l=t.data;l.status?(e.$message({type:"success",message:l.msg}),e.getHelpList(e.myHelpData)):e.$message.error(l.msg)})).catch((function(t){console.log(t)}))})).catch((function(){}))},allShowClick:function(t,e,l){this.helpInfo=t,this.helpInfoShowDialog=!0}},data:function(){return{myTableData:[],allTableData:[],totalMy:0,totalAll:0,addHelpDialog:!1,form:{title:"",content:"",type:[],contact:"",address:"",disasterid:""},formLabelWidth:"90px",options:[{value:"物资",label:"物资"},{value:"食物",label:"食物"},{value:"水",label:"水"}],disasterOptions:[],myHelpData:{size:8,current:1,condition:{eq_createby:this.$store.getters.userid}},allHelpData:{size:10,current:1,condition:{ne_createby:this.$store.getters.userid,eq_isfinish:!1}},helpInfoShowDialog:!1,helpInfo:{}}},filters:{formatTimer:function(t){var e=new Date(t),l=e.getFullYear(),a=e.getMonth()+1;a=a<10?"0"+a:a;var o=e.getDate();o=o<10?"0"+o:o;var i=e.getHours();i=i<10?"0"+i:i;var s=e.getMinutes();s=s<10?"0"+s:s;var r=e.getSeconds();return r=r<10?"0"+r:r,l+"-"+a+"-"+o+" "+i+":"+s}}},n=r,c=(l("ef56"),l("2877")),f=Object(c["a"])(n,a,o,!1,null,null,null);e["default"]=f.exports},ef56:function(t,e,l){"use strict";l("04e7")}}]);